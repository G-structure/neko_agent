# MCP Server Setup Guide

This project is configured with MCP (Model Context Protocol) servers for Claude Code.

## Configured Servers

### 1. cclsp (LSP Bridge for Python & Nix)
**Purpose**: Provides LSP functionality for basedpyright (Python) and nixd (Nix)
**Status**: Requires initial setup

**First-time setup:**
```bash
# Run the interactive setup wizard
npx cclsp@latest setup
```

The wizard will:
- Detect language servers in your environment
- Configure basedpyright for Python type checking
- Configure nixd for Nix language support
- Generate the appropriate configuration

**Manual configuration** (if needed):
1. Install language servers:
   ```bash
   # Python type checking
   npm install -g basedpyright

   # Nix language server (via nix)
   nix profile install nixpkgs#nixd
   ```

2. Create `cclsp.json` in project root with your LSP configurations

### 2. mcp-server-analyzer (Ruff Linting)
**Purpose**: Python code analysis with Ruff linting and Vulture dead code detection
**Status**: Auto-installs via uvx

**No setup required** - automatically installed when Claude Code first accesses it.

**Manual testing:**
```bash
# Test the server
uvx mcp-server-analyzer
```

## Usage

Once configured, Claude Code will automatically:
- Provide Python type checking via basedpyright
- Offer Nix language support via nixd
- Perform Python linting and formatting via Ruff
- Detect dead code using Vulture

## Troubleshooting

### cclsp not working
1. Run the setup wizard: `npx cclsp@latest setup`
2. Verify language servers are installed:
   ```bash
   basedpyright --version
   nixd --version
   ```

### mcp-server-analyzer not working
1. Ensure uv is installed: `curl -LsSf https://astral.sh/uv/install.sh | sh`
2. Test manually: `uvx mcp-server-analyzer`

### Permission errors
Claude Code will prompt for approval before using project-scoped servers on first access.

## Alternative Setup

If you prefer simpler, standalone tools without MCP integration:

```bash
# Direct tool usage
basedpyright src/
ruff check src/
nixd  # for Nix files
```

## References

- [cclsp GitHub](https://github.com/ktnyt/cclsp)
- [mcp-server-analyzer GitHub](https://github.com/Anselmoo/mcp-server-analyzer)
- [Claude Code MCP Docs](https://docs.claude.com/en/docs/claude-code/mcp)
